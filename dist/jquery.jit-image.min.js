/*! jQuery JIT image - v1.1.0 - build 4 - 2014-01-28
* https://github.com/DeuxHuitHuit/jQuery-jit-image
* Copyright (c) 2014 Deux Huit Huit (http://www.deuxhuithuit.com/);
* Licensed MIT */

!function(a,b,c){"use strict";c=c||"data-src-format",b=b||"img["+c+"]",a.fn.on=a.fn.on||a.fn.bind,a.fn.off=a.fn.off||a.fn.unbind;var d=a(window),e=a(),f="jitImageOptions",g=function(){var a=[],b=0,c=0,d=function(){for(;a.length&&b<a[0].limit;){var d=a.shift();b++,d.update()}c=0},e=function(){c||(c=setTimeout(d,0))},f=function(b){a.push(b),e()},g=function(){b>0&&(b--,e())};return{push:f,done:g,count:function(){return a.length},active:function(){return b}}}(),h=function(a){return{width:a.container.width(),height:a.container.height()}},i=function(b,c,d,e,f,h){if(b&&c){e&&c.width?b.attr("width",c.width).width(c.width):b.removeAttr("width").width(""),e&&c.height?b.attr("height",c.height).height(c.height):b.removeAttr("height").height("");var i=function(d){return function(e){var i=[c,e,d];h&&g.done(b,i),a.isFunction(f)&&f.apply(b,i),b.trigger("loaded.jitImage",i)}};d&&b.attr("src")!==d&&(b.off("load.jitImage").off("error.jitImage").one("load.jitImage",i(!1)).one("error.jitImage",i(!0)),b.attr("src",d))}},j=function(a,b,c){var d=a.attr(b.dataAttribute),e={url:d,height:!1,width:!1};return d&&(e.width=b.widthPattern.test(d),e.height=b.heightPattern.test(d),e.url=d.replace(b.widthPattern,~~c.width).replace(b.heightPattern,~~c.height)),e},k=function(a,b){if(b&&a){var c=b.size(b),d=j(a,b,c);d&&c&&(c.height>0||c.width>0)&&(c.width=d.width?c.width:!1,c.height=d.height?c.height:!1,b.set(a,c,d.url,b.forceCssResize,b.load,b.parallelLoadingLimit))}},l=function(){a.each(e,function(b,c){var d=a(c),e=d.data(f),h=d.is(":visible"),i=function(){k(d,d.data(f))};e&&(e.parallelLoadingLimit?g.push({elem:d,visible:h,update:i,limit:e.parallelLoadingLimit}):(clearTimeout(e.jitTimeout),o.nonVisibleDelay&&!h?e.jitTimeout=setTimeout(i,o.nonVisibleDelay):i()))}),p()},m=null,n=function(){clearTimeout(m),m=setTimeout(l,o.eventTimeout)},o={container:null,dataAttribute:c,defaultSelector:b,containerDataAttribute:"data-container",size:h,set:i,widthPattern:/\$w/gi,heightPattern:/\$h/gi,updateEvents:"resize orientationchange",eventTimeout:50,load:a.noop,nonVisibleDelay:1e3,forceCssResize:!0,parallelLoadingLimit:0},p=function(){d.one(o.updateEvents,n)};a.jitImage={remove:function(a){e=e.not(a)},defaults:o,_getSize:h,_set:i,_getUrlFromFormat:j},a.fn.jitImage=function(b){var c=a(this),d=function(c,d){var e=a.extend({},o,b),h=a(d),i=h.attr(e.containerDataAttribute),j=i?h.closest(i):h.parent().length?h.parent():h;e.container=e.container?a(e.container):j,h.data(f,e);var l=function(){k(h,e)};e.parallelLoadingLimit?g.push({elem:h,visible:!0,update:l,limit:e.parallelLoadingLimit}):l()};return e=e.add(c),c.each(d)},d.load(function(){o.defaultSelector&&a(o.defaultSelector).jitImage(),p()})}(jQuery,window.jitImageSelector,window.jitImageDataAttribute);
//# sourceMappingURL=jquery.jit-image.min.js.map