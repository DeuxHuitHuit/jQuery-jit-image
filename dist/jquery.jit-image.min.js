/*! jQuery JIT image - v1.0.0 - 2013-10-23
* https://github.com/DeuxHuitHuit/jQuery-jit-image
* Copyright (c) 2013 Deux Huit Huit Licensed MIT */
(function(e,t,n,r){"use strict";n=n||"data-src-format",t=t||"img["+n+"]",e.fn.on=e.fn.on||e.fn.bind;var i=e(window),s=e(),o="jitImageOptions",u=function(e){return{width:e.container.width(),height:e.container.height()}},a=function(e,t,n){!!e&&!!t&&(t.width?e.attr("width",t.width).width(t.width):e.removeAttr("width").width(""),t.height?e.attr("height",t.height).height(t.height):e.removeAttr("height").height(""),!!n&&e.attr("src")!==n&&e.attr("src",n))},f=function(e,t,n){var r=e.attr(t.dataAttribute),i={url:"",height:!1,width:!1};return!r||(i.width=t.widthPattern.test(r),i.height=t.heightPattern.test(r),i.url=r.replace(t.widthPattern,~~n.width).replace(t.heightPattern,~~n.height)),i},l=function(e,t){if(!!t&&!!e){var n=t.size(t),r=f(e,t,n);!!r&&!!n&&(n.height>0||n.width>0)&&(n.width=r.width?n.width:!1,n.height=r.height?n.height:!1,t.set(e,n,r.url))}},c=function(){e.each(s,function(n,r){var i=e(r);l(i,i.data(o))}),setTimeout(v,d.eventTimeout)},h=null,p=function(e){clearTimeout(h),h=setTimeout(c,d.eventTimeout)},d={container:null,dataAttribute:n,defaultSelector:t,containerDataAttribute:"data-container",size:u,set:a,widthPattern:/\$w/gi,heightPattern:/\$h/gi,updateEvents:"resize orientationchange",eventTimeout:50},v=function(){i.one(d.updateEvents,p)};e.jitImage={remove:function(e){s=s.not(e)},defaults:d,_getSize:u,_set:a,_getUrlFromFormat:f},e.fn.jitImage=function(t){var n=e(this),r=function(n,r){var i=e.extend({},d,t),s=e(r),u=s.attr(i.containerDataAttribute);return i.container=i.container?e(i.container):u?s.closest(u):s.parent(),s.data(o,i),l(s,i)};return s=s.add(n),n.each(r)},i.load(function(){e(d.defaultSelector).jitImage(),v()})})(jQuery,window.jitImageSelector,window.jitImageDataAttribute);