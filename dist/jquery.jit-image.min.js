/*! jQuery JIT image - v1.2.0 - build 11 - 2014-01-31
* https://github.com/DeuxHuitHuit/jQuery-jit-image
* Copyright (c) 2014 Deux Huit Huit (http://www.deuxhuithuit.com/);
* Licensed MIT */

!function(a,b,c){"use strict";c=c||"data-src-format",b=b||"img["+c+"]",a.fn.on=a.fn.on||a.fn.bind,a.fn.off=a.fn.off||a.fn.unbind;var d=a(window),e=a(),f="jitImageOptions",g=function(){var b=[],c=0,d=0,e=function(){for(;b.length&&(c<b[0].limit||!c);){var a=b.shift();c++,a.update()}d=0},f=function(){d||(d=setTimeout(e,0))},g=function(c){var d=!1;a.each(b,function(a,e){return e.elem.is(c.elem)?(b[a]=c,d=!0):void 0}),d||b.push(c),f()},h=function(){c>0&&c--,f()};return{push:g,done:h,check:f,count:function(){return b.length},active:function(){return c},queue:function(){return b}}}(),h=function(a){return{width:a.container.width(),height:a.container.height()}},i=function(b,c,d,e,f,h){if(b&&c){e&&c.width?b.attr("width",c.width).width(c.width):b.removeAttr("width").width(""),e&&c.height?b.attr("height",c.height).height(c.height):b.removeAttr("height").height("");var i=function(){return b.off("load.jitImage").off("error.jitImage")},j=function(d){return function(e){i();var j=[c,e,d];h&&g.done(b,j),a.isFunction(f)&&f.apply(b,j),b.trigger("loaded.jitImage",j)}};if(d&&b.attr("src")!==d)return i().on("load.jitImage",j(!1)).on("error.jitImage",j(!0)),b.attr("src",d),!0}return!1},j=function(a,b,c){var d=a.attr(b.dataAttribute),e={url:d,height:!1,width:!1,formatted:!1};return d&&(e.width=b.widthPattern.test(d),e.height=b.heightPattern.test(d),e.width&&(d=d.replace(b.widthPattern,~~c.width)),e.height&&(d=d.replace(b.heightPattern,~~c.height)),e.url=d,e.formatted=e.width||e.height),e},k=function(a,b){var c=!1;if(b&&a){var d=b.size(b),e=j(a,b,d),f=!!e&&!!e.url,h=!!d&&(d.height>0||d.width>0);f&&h&&(d.width=e.width?d.width:!1,d.height=e.height?d.height:!1,c=b.set(a,d,e.url,b.forceCssResize,b.load,b.parallelLoadingLimit))}!c&&b.parallelLoadingLimit&&g.done(a,[null,null,!0])},l=function(){a.each(e,function(b,c){var d=a(c),e=d.data(f),h=d.is(":visible"),i=function(){k(d,e)};e&&(e.parallelLoadingLimit?g.push({elem:d,visible:h,update:i,limit:e.parallelLoadingLimit}):(clearTimeout(e.jitTimeout),o.nonVisibleDelay&&!h?e.jitTimeout=setTimeout(i,o.nonVisibleDelay):i()))}),p()},m=null,n=function(){clearTimeout(m),m=setTimeout(l,o.eventTimeout)},o={container:null,dataAttribute:c,defaultSelector:b,containerDataAttribute:"data-container",size:h,set:i,widthPattern:/\$w/i,heightPattern:/\$h/i,updateEvents:"resize orientationchange",eventTimeout:50,load:a.noop,nonVisibleDelay:1e3,forceCssResize:!0,parallelLoadingLimit:0},p=function(){d.one(o.updateEvents,n)};a.jitImage={remove:function(a){e=e.not(a)},defaults:o,_getSize:h,_set:i,_getUrlFromFormat:j,loader:g},a.fn.jitImage=function(b){var c=a(this),d=function(c,d){var e=a(d),h=e.data(f)||{},i=a.extend({},o,h,b),j=e.attr(i.containerDataAttribute),l=j?e.closest(j):e.parent().length?e.parent():e;i.container=i.container?a(i.container):l,e.data(f,i);var m=function(){k(e,i)};i.parallelLoadingLimit?g.push({elem:e,visible:!0,update:m,limit:i.parallelLoadingLimit}):m()};return e=e.add(c),c.each(d)},d.load(function(){o.defaultSelector&&a(o.defaultSelector).jitImage(),p()})}(jQuery,window.jitImageSelector,window.jitImageDataAttribute);
//# sourceMappingURL=jquery.jit-image.min.js.map